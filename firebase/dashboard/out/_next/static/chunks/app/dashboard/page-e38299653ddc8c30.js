(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{9521:function(e,t,s){Promise.resolve().then(s.bind(s,2093))},2093:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return D}});var a=s(7437),i=s(2265),r=s(2582),l=s(9376);class n{getQualityFromPPM(e){return e<50?"Excellent":e<100?"Good":e<200?"Moderate":e<350?"Poor":e<500?"Very Poor":"Hazardous"}getSeverityFromQuality(e){switch(e){case"Hazardous":case"Very Poor":return"critical";case"Poor":return"high";case"Moderate":return"medium";default:return"low"}}updateTrend(){let e=Date.now();if(e-this.lastChangeTime>1e4+2e4*Math.random()){let t=["rising","falling","stable"];this.trend=t[Math.floor(Math.random()*t.length)],this.lastChangeTime=e}}calculateNextPPM(){this.updateTrend();let e=0;switch(this.trend){case"rising":e=2+8*Math.random();break;case"falling":e=-(2+8*Math.random());break;case"stable":e=10*Math.random()-5}let t=this.currentPPM+e;return t=Math.max(20,Math.min(1200,t)),.05>Math.random()&&(t+=Math.random()>.5?200:-100,t=Math.max(20,Math.min(1200,t))),this.currentPPM=t,t}shouldRelayBeOn(e){return["Poor","Very Poor","Hazardous"].includes(e)?"ON":"OFF"}generateReading(){let e=this.calculateNextPPM(),t=this.getQualityFromPPM(e),s=this.shouldRelayBeOn(t);return{device_id:this.deviceId,ppm:e,quality:t,relay_state:s,timestamp:new Date().toISOString()}}generateHistoricalData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=[],s=new Date;for(let a=e-1;a>=0;a--){let e=new Date(s.getTime()-6e4*a),i=this.generateReading();i.timestamp=e.toISOString(),t.push(i)}return t}generateAlertEntry(){let e=this.generateReading(),t=this.getSeverityFromQuality(e.quality);if("low"===t)return null;let s={id:"sim-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:e.timestamp,ppm:e.ppm,quality:e.quality,severity:t,device_id:e.device_id,relay_state:e.relay_state,isSimulated:!0};return this.alertHistory.push(s),this.alertHistory.length>100&&(this.alertHistory=this.alertHistory.slice(-100)),s}getAlertHistory(){return[...this.alertHistory].reverse()}clearAlertHistory(){this.alertHistory=[]}setScenario(e){switch(e){case"normal":this.currentPPM=150+100*Math.random(),this.trend="stable";break;case"warning":this.currentPPM=300+200*Math.random(),this.trend=Math.random()>.5?"rising":"stable";break;case"critical":this.currentPPM=600+400*Math.random(),this.trend=Math.random()>.3?"rising":"stable";break;case"recovery":this.currentPPM=Math.max(100,this.currentPPM-200),this.trend="falling"}this.lastChangeTime=Date.now()}getCurrentState(){return{ppm:this.currentPPM,quality:this.getQualityFromPPM(this.currentPPM),trend:this.trend,deviceId:this.deviceId}}constructor(e="ESP32_SIM_01"){this.deviceId=e,this.currentPPM=200,this.trend="stable",this.lastChangeTime=Date.now(),this.alertHistory=[]}}class o{setListeners(e){this.listeners={...this.listeners,...e}}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.isRunning||(this.updateInterval=e,this.isRunning=!0,this.intervalRef=setInterval(()=>{var e,t,s,a,i,r,l,n;if(!this.isRunning)return;let o=this.generator.generateReading();if(null===(e=(t=this.listeners).onNewReading)||void 0===e||e.call(t,o),.3>Math.random()){let e=this.generator.generateAlertEntry();e&&(null===(i=(r=this.listeners).onNewAlert)||void 0===i||i.call(r,e))}.02>Math.random()&&(this.simulatedDeviceOnline=!this.simulatedDeviceOnline,null===(l=(n=this.listeners).onDeviceStatusChange)||void 0===l||l.call(n,this.simulatedDeviceOnline)),this.simulatedCommands.relay_state=o.relay_state,this.simulatedCommands.last_update=Date.now(),null===(s=(a=this.listeners).onCommandUpdate)||void 0===s||s.call(a,this.simulatedCommands)},this.updateInterval))}stop(){this.isRunning=!1,this.intervalRef&&(clearInterval(this.intervalRef),this.intervalRef=null)}isSimulationRunning(){return this.isRunning}setUpdateInterval(e){this.updateInterval=e,this.isRunning&&(this.stop(),this.start(e))}getHistoricalData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.generator.generateHistoricalData(e)}getAlertHistory(){return this.generator.getAlertHistory()}clearAlertHistory(){this.generator.clearAlertHistory()}setScenario(e){this.generator.setScenario(e)}getCurrentReading(){return this.generator.generateReading()}getDeviceStatus(){return this.simulatedDeviceOnline}getCurrentCommands(){return{...this.simulatedCommands}}updateCommand(e){var t,s;this.simulatedCommands={...this.simulatedCommands,...e,last_update:Date.now()},null===(t=(s=this.listeners).onCommandUpdate)||void 0===t||t.call(s,this.simulatedCommands)}getSimulationState(){return{isRunning:this.isRunning,updateInterval:this.updateInterval,deviceOnline:this.simulatedDeviceOnline,generatorState:this.generator.getCurrentState()}}destroy(){this.stop(),this.listeners={}}constructor(){this.intervalRef=null,this.listeners={},this.isRunning=!1,this.updateInterval=1e3,this.simulatedDeviceOnline=!0,this.generator=new n,this.simulatedCommands={relay_state:"OFF",sampling_interval:5,oled_message:"Simulation Active",last_update:Date.now()}}}let d=(0,i.createContext)(void 0);function c(e){let{children:t}=e,s=function(){let[e,t]=(0,i.useState)(!1),[s]=(0,i.useState)(()=>new o),[a,r]=(0,i.useState)([]),[l,n]=(0,i.useState)([]),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(!0),[h,x]=(0,i.useState)(null);return(0,i.useEffect)(()=>(s.setListeners({onNewReading:e=>{c(e),r(t=>[...t.slice(-99),e])},onNewAlert:e=>{n(t=>[e,...t.slice(0,99)])},onDeviceStatusChange:e=>{u(e)},onCommandUpdate:e=>{x(e)}}),()=>{s.destroy()}),[s]),{isSimulationMode:e,simulatedData:a,simulatedAlerts:l,currentReading:d,deviceOnline:m,deviceCommands:h,startSimulation:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,a=s.getHistoricalData(30);r(a),c(a[a.length-1]),s.start(e),t(!0)},stopSimulation:()=>{s.stop(),t(!1),r([]),n([]),c(null),x(null)},setSimulationScenario:e=>{s.setScenario(e)},updateSimulationCommand:e=>{s.updateCommand(e)},simulationState:s.getSimulationState()}}(),r={isSimulationMode:s.isSimulationMode,simulatedData:s.simulatedData,simulatedAlerts:s.simulatedAlerts,currentReading:s.currentReading,deviceOnline:s.deviceOnline,deviceCommands:s.deviceCommands,startSimulation:s.startSimulation,stopSimulation:s.stopSimulation,setSimulationScenario:s.setSimulationScenario,updateSimulationCommand:s.updateSimulationCommand,simulationState:s.simulationState};return(0,a.jsx)(d.Provider,{value:r,children:t})}function m(){let e=(0,i.useContext)(d);if(void 0===e)throw Error("useSimulationContext must be used within a SimulationProvider");return e}function u(e){let t=m();return{currentReading:t.isSimulationMode?t.currentReading:e.currentReading,historicalData:t.isSimulationMode?t.simulatedData:e.historicalData,deviceOnline:t.isSimulationMode?t.deviceOnline:e.deviceOnline,deviceCommands:t.isSimulationMode?t.deviceCommands:e.deviceCommands,isSimulated:t.isSimulationMode}}var h=s(3439);function x(e){let{reading:t}=e,{isSimulated:s}=u({currentReading:t,historicalData:[],deviceOnline:!1,deviceCommands:null}),i=e=>{switch(e){case"Excellent":return"bg-green-500";case"Good":return"bg-blue-500";case"Moderate":return"bg-yellow-500";case"Poor":return"bg-orange-500";case"Very Poor":return"bg-red-500";case"Hazardous":return"bg-purple-600";default:return"bg-gray-500"}};if(!t)return(0,a.jsx)(h.Z,{className:"p-6",children:(0,a.jsx)("div",{className:"flex items-center justify-center h-40",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-3 w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-white",children:"Loading sensor data..."})]})})});let r=(e=>{switch(e){case"Excellent":case"Good":return{status:"SAFE",color:"text-white bg-green-500/50"};case"Moderate":return{status:"CAUTION",color:"text-white bg-yellow-500/50"};case"Poor":return{status:"WARNING",color:"text-white bg-orange-500/50"};case"Very Poor":case"Hazardous":return{status:"UNSAFE",color:"text-white bg-red-500/50"};default:return{status:"UNKNOWN",color:"text-white bg-gray-500/50"}}})(t.quality),l=Date.now()-new Date(t.timestamp).getTime()<3e4;return(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Air Quality"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[l&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-white/20 px-2 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(i(t.quality)," animate-pulse")}),(0,a.jsx)("span",{className:"text-xs font-medium text-white",children:"LIVE"})]}),s&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-white/20 px-2 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-white",children:"SIM"})]})]})]}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(i(t.quality)," animate-pulse shadow-lg")})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"inline-flex items-center px-4 py-2 rounded-full text-sm font-bold text-white ".concat(r.color," transition-all duration-300 backdrop-blur-sm border border-white/30"),children:r.status})}),(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-white transition-all duration-300 hover:scale-105",children:t.ppm.toFixed(1)}),(0,a.jsx)("div",{className:"text-sm text-white font-medium mt-1",children:"PPM"})]})}),(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)("div",{className:"inline-block px-4 py-2 rounded-full text-sm font-semibold ".concat(i(t.quality)," text-white transition-all duration-300 hover:scale-105"),children:t.quality})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Relay Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("ON"===t.relay_state?"bg-green-500":"bg-gray-400")}),(0,a.jsx)("span",{className:"text-sm font-semibold ".concat("ON"===t.relay_state?"text-green-600":"text-white"),children:t.relay_state})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Device ID"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:t.device_id})]})]}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-white text-center",children:["Last updated: ",new Date(t.timestamp).toLocaleString()]})]})}function g(e){let{online:t,lastUpdate:s}=e,{isSimulated:i,deviceOnline:r}=u({currentReading:null,historicalData:[],deviceOnline:t,deviceCommands:null}),l=i?r:t,n=(()=>{if(!s)return{quality:"Unknown",color:"text-gray-500",strength:0};let e=new Date,t=new Date(s),a=Math.floor((e.getTime()-t.getTime())/6e4);return a<2?{quality:"Excellent",color:"text-green-600",strength:100}:a<5?{quality:"Good",color:"text-blue-600",strength:75}:a<15?{quality:"Fair",color:"text-yellow-600",strength:50}:a<30?{quality:"Poor",color:"text-orange-600",strength:25}:{quality:"Very Poor",color:"text-red-600",strength:0}})();return(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Device Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(l?"bg-green-500":"bg-red-500"," ").concat(l?"animate-pulse":""," shadow-lg")}),i&&(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"})]})]}),(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsxs)("div",{className:"inline-flex items-center px-6 py-3 rounded-full text-lg font-bold text-white transition-all duration-300 bg-white/20 backdrop-blur-sm border border-white/30",children:[l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Online"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"Offline"]}),i&&(0,a.jsx)("span",{className:"ml-2 text-xs bg-white/20 text-white px-2 py-1 rounded backdrop-blur-sm border border-white/30",children:"SIM"})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Device ID"}),(0,a.jsx)("span",{className:"text-sm font-bold text-white",children:i?"ESP32_SIM_01":"ESP32_01"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Last Update"}),(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:(()=>{if(!s)return"Never";let e=new Date,t=new Date(s),a=Math.floor((e.getTime()-t.getTime())/6e4);if(a<1)return"Just now";if(a<60)return"".concat(a," min ago");let i=Math.floor(a/60);if(i<24)return"".concat(i," hour").concat(i>1?"s":""," ago");let r=Math.floor(i/24);return"".concat(r," day").concat(r>1?"s":""," ago")})()})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Connection"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(l?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm font-semibold ".concat("text-white"),children:l?"Connected":"Disconnected"})]})]})]}),l&&(0,a.jsxs)("div",{className:"p-4 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Signal Quality"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-white",children:n.quality})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200/50 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(n.strength>=75?"bg-green-500":n.strength>=50?"bg-blue-500":n.strength>=25?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(n.strength,"%")}})})]}),(0,a.jsx)("div",{className:"pt-4 border-t border-gray-200/30",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-full ".concat(l?"bg-green-100/50":"bg-gray-100/50"),children:(0,a.jsx)("svg",{className:"w-6 h-6 ".concat(l?"text-green-600":"text-white"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("div",{className:"text-sm font-semibold text-white",children:l?"System Active":"System Inactive"}),(0,a.jsxs)("div",{className:"text-xs text-white",children:[l?"Monitoring正常运行":"Awaiting connection",i&&" (Simulated)"]})]})]})})]})]})}function b(e){let{currentCommands:t,onCommandUpdate:s}=e,{isSimulationMode:r,startSimulation:l,stopSimulation:n,setSimulationScenario:o,updateSimulationCommand:d}=m(),[c,u]=(0,i.useState)((null==t?void 0:t.relay_state)||"OFF"),[x,g]=(0,i.useState)((null==t?void 0:t.sampling_interval)||5),[b,p]=(0,i.useState)((null==t?void 0:t.oled_message)||""),v=()=>{let e="ON"===c?"OFF":"ON";u(e),r?d({relay_state:e,last_update:Date.now()}):s({relay_state:e,last_update:Date.now()})},w=e=>{g(e),r?d({sampling_interval:e,last_update:Date.now()}):s({sampling_interval:e,last_update:Date.now()})};return(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-6",children:"Device Controls"}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Simulation Mode"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Generate fake sensor data for testing"})]}),(0,a.jsx)("button",{onClick:()=>{r?n():l()},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(r?"bg-green-600":"bg-gray-200"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(r?"translate-x-6":"translate-x-1")})})]}),(0,a.jsx)("div",{className:"text-xs ".concat(r?"text-green-600":"text-gray-500"),children:r?"✅ Simulation Active - Using fake data":"\uD83D\uDCE1 Real Mode - Using device data"})]}),r&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50/50 backdrop-blur-sm border border-blue-200/30 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-white mb-3",children:"Simulation Scenarios"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{onClick:()=>o("normal"),className:"px-3 py-2 bg-green-100 text-green-800 text-xs font-medium rounded hover:bg-green-200 transition-colors",children:"Normal (150-250 PPM)"}),(0,a.jsx)("button",{onClick:()=>o("warning"),className:"px-3 py-2 bg-yellow-100 text-yellow-800 text-xs font-medium rounded hover:bg-yellow-200 transition-colors",children:"Warning (300-500 PPM)"}),(0,a.jsx)("button",{onClick:()=>o("critical"),className:"px-3 py-2 bg-red-100 text-red-800 text-xs font-medium rounded hover:bg-red-200 transition-colors",children:"Critical (600-1000 PPM)"}),(0,a.jsx)("button",{onClick:()=>o("recovery"),className:"px-3 py-2 bg-blue-100 text-blue-800 text-xs font-medium rounded hover:bg-blue-200 transition-colors",children:"Recovery Mode"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white mb-3",children:"Relay Control"}),(0,a.jsx)("button",{onClick:v,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat("ON"===c?"bg-green-600":"bg-gray-200"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat("ON"===c?"translate-x-6":"translate-x-1")})}),(0,a.jsxs)("span",{className:"ml-3 text-sm text-white",children:["Relay is ","ON"===c?"ON":"OFF"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-white mb-3",children:["Sampling Interval: ",x," seconds"]}),(0,a.jsx)("input",{type:"range",min:"1",max:"60",value:x,onChange:e=>w(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-white mt-1",children:[(0,a.jsx)("span",{children:"1s"}),(0,a.jsx)("span",{children:"30s"}),(0,a.jsx)("span",{children:"60s"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-white mb-3",children:"OLED Message"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("input",{type:"text",value:b,onChange:e=>p(e.target.value),placeholder:"Enter custom message",maxLength:50,className:"w-full px-3 py-2 border border-white/30 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white/20 backdrop-blur-sm text-white"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{r?d({oled_message:b,last_update:Date.now()}):s({oled_message:b,last_update:Date.now()}),"CLEAR"===b&&p("")},className:"flex-1 px-3 py-2 bg-white/30 backdrop-blur-sm text-white text-sm font-medium rounded-md hover:bg-white/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 border border-white/30",children:"Send Message"}),(0,a.jsx)("button",{onClick:()=>{p("CLEAR"),s({oled_message:"CLEAR",last_update:Date.now()})},className:"px-3 py-2 bg-white/30 backdrop-blur-sm text-white text-sm font-medium rounded-md hover:bg-white/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 border border-white/30",children:"Clear"})]})]}),(0,a.jsx)("p",{className:"text-xs text-white mt-1",children:'Type "CLEAR" to clear the display'})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200/30",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-white mb-3",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("button",{onClick:()=>{p("Air Quality OK"),s({oled_message:"Air Quality OK",last_update:Date.now()})},className:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white text-xs font-medium rounded hover:bg-white/30 border border-white/30",children:"Status OK"}),(0,a.jsx)("button",{onClick:()=>{p("Warning!"),s({oled_message:"Warning!",last_update:Date.now()})},className:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white text-xs font-medium rounded hover:bg-white/30 border border-white/30",children:"Warning"}),(0,a.jsx)("button",{onClick:()=>{v()},className:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white text-xs font-medium rounded hover:bg-white/30 border border-white/30",children:"Toggle Relay"}),(0,a.jsx)("button",{onClick:()=>{w(10)},className:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white text-xs font-medium rounded hover:bg-white/30 border border-white/30",children:"Reset (10s)"})]})]}),t&&(0,a.jsx)("div",{className:"pt-4 border-t border-gray-200/30",children:(0,a.jsxs)("p",{className:"text-xs text-white",children:["Last command sent: ",new Date(t.last_update).toLocaleString()]})})]})]})}var p=s(4084),v=s(6705);function w(e){let{data:t}=e,{isSimulated:s}=u({currentReading:null,historicalData:t,deviceOnline:!1,deviceCommands:null}),[r,l]=(0,i.useState)("24h"),[n,o]=(0,i.useState)(t),[d,c]=(0,i.useState)(!0),m=(0,i.useRef)();(0,i.useEffect)(()=>{let e=new Date,s=[...t];switch(r){case"1h":let a=new Date(e.getTime()-36e5);s=t.filter(e=>new Date(e.timestamp)>=a);break;case"6h":let i=new Date(e.getTime()-216e5);s=t.filter(e=>new Date(e.timestamp)>=i);break;case"24h":let l=new Date(e.getTime()-864e5);s=t.filter(e=>new Date(e.timestamp)>=l);break;case"7d":let n=new Date(e.getTime()-6048e5);s=t.filter(e=>new Date(e.timestamp)>=n);break;default:s=t}o(s)},[t,r]),(0,i.useEffect)(()=>(d&&("1h"===r||"6h"===r)?m.current=setInterval(()=>{o(e=>[...e])},5e3):m.current&&clearInterval(m.current),()=>{m.current&&clearInterval(m.current)}),[d,r]);let x={labels:n.map(e=>new Date(e.timestamp)),datasets:[{label:"Gas/Smoke PPM Level",data:n.map(e=>e.ppm),borderColor:"rgb(96, 165, 250)",backgroundColor:"rgba(96, 165, 250, 0.1)",tension:.4,fill:!0,pointRadius:n.length<=50?4:2,pointHoverRadius:6,pointBackgroundColor:"rgb(96, 165, 250)",pointBorderColor:"#fff",pointBorderWidth:1,borderWidth:3},{label:"Quality Thresholds",data:n.map(e=>({Excellent:50,Good:100,Moderate:200,Poor:350,"Very Poor":500,Hazardous:1e3})[e.quality]||0),borderColor:"rgb(248, 113, 113)",backgroundColor:"rgba(248, 113, 113, 0.1)",borderDash:[5,5],tension:.4,fill:!1,pointRadius:0,pointHoverRadius:0,borderWidth:2}]},g=(()=>{if(0===n.length)return{avg:0,min:0,max:0,trend:"stable"};let e=n.map(e=>e.ppm),t=e.reduce((e,t)=>e+t,0)/e.length,s=e.slice(-10),a=e.slice(-20,-10),i=s.reduce((e,t)=>e+t,0)/s.length,r=a.length>0?a.reduce((e,t)=>e+t,0)/a.length:i,l="stable";return i>1.1*r?l="rising":i<.9*r&&(l="falling"),{avg:t,min:Math.min(...e),max:Math.max(...e),trend:l}})(),b=n[n.length-1];return(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 space-y-4 lg:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Air Quality Trends"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[d&&("1h"===r||"6h"===r)&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-red-500/20 px-2 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-white",children:"LIVE"})]}),s&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-yellow-500/20 px-2 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-white",children:"SIM"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[["1h","6h","24h","7d","all"].map(e=>(0,a.jsx)("button",{onClick:()=>l(e),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat(r===e?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm"),children:"1h"===e?"1 Hour":"6h"===e?"6 Hours":"24h"===e?"24 Hours":"7d"===e?"7 Days":"All Time"},e)),("1h"===r||"6h"===r)&&(0,a.jsx)("button",{onClick:()=>c(!d),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat(d?"bg-red-600 text-white shadow-md":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm"),children:d?"Pause":"Live"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:g.avg.toFixed(1)}),(0,a.jsx)("div",{className:"text-xs text-white font-medium",children:"Average PPM"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:g.min.toFixed(1)}),(0,a.jsx)("div",{className:"text-xs text-white font-medium",children:"Min PPM"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:g.max.toFixed(1)}),(0,a.jsx)("div",{className:"text-xs text-white font-medium",children:"Max PPM"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat("rising"===g.trend?"text-red-400":"falling"===g.trend?"text-green-400":"text-gray-400"),children:"rising"===g.trend?"↑":"falling"===g.trend?"↓":"→"}),(0,a.jsx)("div",{className:"text-xs text-white font-medium",children:"Trend"})]}),b&&(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white",children:b.ppm.toFixed(1)}),(0,a.jsx)("div",{className:"text-xs text-white font-medium",children:"Current PPM"})]})]}),(0,a.jsx)("div",{className:"chart-container",style:{height:"400px"},children:n.length>0?(0,a.jsx)(v.x1,{data:x,options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},animation:{duration:d?750:1e3},plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:15,color:"white",font:{size:12}}},title:{display:!0,text:"Real-Time Air Quality Monitoring",color:"white",font:{size:16,weight:"bold"}},tooltip:{backgroundColor:"rgba(30, 41, 59, 0.9)",titleColor:"white",bodyColor:"white",borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1,padding:12,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},callbacks:{label:function(e){let t=e.dataset.label||"";if(t&&(t+=": "),0===e.datasetIndex){t+=e.parsed.y.toFixed(1)+" PPM";let s=n[e.dataIndex];s&&(t+=" (".concat(s.quality,")"))}else t+=e.parsed.y.toFixed(0)+" PPM Threshold";return t},afterLabel:function(e){if(0===e.datasetIndex&&n[e.dataIndex]){let t=n[e.dataIndex];return["Device: ".concat(t.device_id),"Relay: ".concat(t.relay_state),"Time: ".concat(new Date(t.timestamp).toLocaleString())]}return[]}}}},scales:{x:{type:"time",time:{displayFormats:{minute:"HH:mm",hour:"HH:mm",day:"MMM dd"}},grid:{display:!1,color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"white"},title:{display:!1}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"PPM Level",color:"white",font:{size:12,weight:"bold"}},grid:{color:"rgba(255, 255, 255, 0.1)"},ticks:{color:"white"},suggestedMin:0}}}}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-white",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,a.jsx)("p",{className:"mt-2 text-lg font-medium",children:"No data available"}),(0,a.jsx)("p",{className:"text-sm text-gray-300",children:"Try selecting a different time range"})]})})}),(0,a.jsxs)("div",{className:"mt-4 flex justify-between items-center text-sm text-white",children:[(0,a.jsxs)("span",{children:["Showing ",n.length," data points"]}),b&&(0,a.jsxs)("span",{children:["Last updated: ",new Date(b.timestamp).toLocaleTimeString()]})]})]})}function f(e){let{reading:t,deviceOnline:s}=e,{isSimulated:r}=u({currentReading:t,historicalData:[],deviceOnline:s,deviceCommands:null}),l=(()=>{if(!s)return{status:"UNKNOWN",level:"unknown",color:"bg-gray-100 text-white border-gray-300",bgColor:"bg-gray-100/20",textColor:"text-white",icon:"❓",message:"Device offline - Cannot determine safety status",recommendation:"Check device connection and power supply",description:"No data available from the sensor. Please verify the device is online and transmitting data.",statusOrder:0};if(!t)return{status:"UNKNOWN",level:"unknown",color:"bg-gray-100 text-white border-gray-300",bgColor:"bg-gray-100/20",textColor:"text-white",icon:"❓",message:"No recent data available",recommendation:"Waiting for sensor readings",description:"The system is waiting for new sensor data to evaluate air quality conditions.",statusOrder:0};switch(t.quality){case"Excellent":return{status:"SAFE",level:"safe",color:"bg-green-100 text-white border-green-300",bgColor:"bg-green-100/20",textColor:"text-white",icon:"\uD83C\uDF3F",message:"Air quality is excellent - Safe for all activities",recommendation:"Normal ventilation is sufficient",description:"The air quality is ideal. No health concerns for any population group.",statusOrder:6};case"Good":return{status:"SAFE",level:"safe",color:"bg-green-100 text-white border-green-300",bgColor:"bg-green-100/20",textColor:"text-white",icon:"\uD83D\uDE0A",message:"Air quality is good - Safe for normal activities",recommendation:"Maintain normal ventilation",description:"The air quality is satisfactory. No special attention needed.",statusOrder:5};case"Moderate":return{status:"CAUTION",level:"caution",color:"bg-yellow-100 text-white border-yellow-300",bgColor:"bg-yellow-100/20",textColor:"text-white",icon:"⚠️",message:"Air quality is moderate - Sensitive individuals should take precautions",recommendation:"Consider increasing ventilation, limit prolonged outdoor activities",description:"The air quality is acceptable for general population but may be of concern for sensitive individuals.",statusOrder:4};case"Poor":return{status:"WARNING",level:"warning",color:"bg-orange-100 text-white border-orange-300",bgColor:"bg-orange-100/20",textColor:"text-white",icon:"\uD83D\uDE37",message:"Air quality is poor - Health effects may be felt by sensitive groups",recommendation:"Increase ventilation, avoid prolonged exposure, consider air purification",description:"The air quality is unsatisfactory and poses health risks for sensitive groups.",statusOrder:3};case"Very Poor":return{status:"UNSAFE",level:"unsafe",color:"bg-red-500/50 text-white border-red-300",bgColor:"bg-red-500/50",textColor:"text-white",icon:"\uD83D\uDEA8",message:"Air quality is very poor - Everyone may experience health effects",recommendation:"Minimize exposure, use air purifiers, avoid outdoor activities",description:"The air quality is poor and everyone may experience health effects.",statusOrder:2};case"Hazardous":return{status:"HAZARDOUS",level:"hazardous",color:"bg-purple-500/30 text-white border-purple-300",bgColor:"bg-purple-500/30",textColor:"text-white",icon:"☣️",message:"Air quality is hazardous - Emergency conditions",recommendation:"Stay indoors, seal windows/doors, use air purifiers, seek medical attention if symptoms occur",description:"The air quality is hazardous and poses serious health risks to everyone. Avoid any outdoor exposure.",statusOrder:1};default:return{status:"UNKNOWN",level:"unknown",color:"bg-gray-500/30 text-white border-gray-300",bgColor:"bg-gray-500/30",textColor:"text-white",icon:"❓",message:"Unable to determine air quality status",recommendation:"Check sensor functionality and calibration",description:"The system could not determine air quality level. Please verify sensor functionality.",statusOrder:0}}})(),n=t&&Date.now()-new Date(t.timestamp).getTime()<6e4,[o,d]=(0,i.useState)(!1),c=()=>"safe"===l.level?"bg-green-500":"caution"===l.level?"bg-yellow-500":"warning"===l.level?"bg-orange-500":"unsafe"===l.level||"hazardous"===l.level?"bg-red-500":"bg-gray-500";return(0,a.jsxs)(h.Z,{className:"p-6 transition-all duration-500",children:[(0,a.jsx)("div",{role:"region","aria-label":"Air Quality and Safety Status",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Air Quality & Safety Status"}),(0,a.jsx)("p",{className:"text-sm text-gray-200 mt-1",children:"Real-time monitoring of air quality conditions"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[n&&s&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-green-500/10 px-3 py-1.5 rounded-full",role:"status","aria-label":"Live data indicator",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse","aria-hidden":"true"}),(0,a.jsx)("span",{className:"text-xs font-medium text-green-200",children:"LIVE"})]}),r&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-yellow-500/10 px-3 py-1.5 rounded-full",role:"status","aria-label":"Simulated data indicator",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse","aria-hidden":"true"}),(0,a.jsx)("span",{className:"text-xs font-medium text-white",children:"SIMULATED"})]}),(0,a.jsx)("button",{onClick:()=>d(!o),className:"text-xs font-medium px-3 py-1.5 rounded-full bg-white/20 text-white hover:bg-white/30 transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 backdrop-blur-sm border border-white/30","aria-expanded":o,"aria-controls":"safety-details",children:o?"Hide Details":"Show Details"})]})]})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"text-4xl sm:text-5xl",role:"img","aria-label":"Status icon: ".concat(l.status),children:l.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-white capitalize","aria-label":"Safety status: ".concat(l.status),children:l.status}),(0,a.jsxs)("div",{className:"text-xs sm:text-sm font-medium text-gray-200 uppercase",children:[l.level," level"]})]})]}),(0,a.jsx)("div",{className:"hidden md:block w-32 h-3 bg-gray-200/50 rounded-full overflow-hidden",role:"progressbar","aria-valuenow":l.statusOrder/6*100,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Air quality safety percentage",children:(0,a.jsx)("div",{className:"h-full ".concat(c()," transition-all duration-1000 ease-out"),style:{width:"".concat(l.statusOrder/6*100,"%")}})})]}),(0,a.jsx)("div",{className:"md:hidden w-full h-2 bg-gray-200/50 rounded-full overflow-hidden mb-4",role:"progressbar","aria-valuenow":l.statusOrder/6*100,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Air quality safety percentage",children:(0,a.jsx)("div",{className:"h-full ".concat(c()," transition-all duration-1000 ease-out"),style:{width:"".concat(l.statusOrder/6*100,"%")}})})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 rounded-xl bg-white/30 backdrop-blur-sm border border-white/20","aria-label":"Air quality status description",children:[(0,a.jsx)("p",{className:"text-base font-medium text-white mb-2",children:l.message}),(0,a.jsx)("p",{className:"text-sm text-gray-200",children:l.description})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-white mb-2",children:"Recommended Actions"}),(0,a.jsx)("div",{className:"".concat(l.bgColor," p-4 rounded-xl border border-white/20"),"aria-label":"Recommended actions for current air quality",children:(0,a.jsx)("p",{className:"text-sm text-white",children:l.recommendation})})]}),o&&(0,a.jsxs)("div",{id:"safety-details",className:"space-y-4 pt-4 border-t border-gray-200/30","aria-live":"polite",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-white",children:"Sensor Data"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t&&(0,a.jsx)("div",{className:"p-4 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",role:"region","aria-label":"Sensor readings",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-white font-medium",children:"Current PPM:"}),(0,a.jsx)("span",{className:"ml-2 font-bold text-white",children:t.ppm.toFixed(1)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-white font-medium",children:"Quality Level:"}),(0,a.jsx)("span",{className:"ml-2 font-bold text-white",children:t.quality})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-white font-medium",children:"Relay Status:"}),(0,a.jsx)("span",{className:"ml-2 font-bold ".concat("ON"===t.relay_state?"text-green-400":"text-gray-400"),children:t.relay_state})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-white font-medium",children:"Device Status:"}),(0,a.jsx)("span",{className:"ml-2 font-bold ".concat(s?"text-green-400":"text-red-400"),children:s?"Online":"Offline"})]})]})})}),(0,a.jsx)("div",{className:"text-center text-xs text-white py-2","aria-label":"Last data update: ".concat(t?new Date(t.timestamp).toLocaleString():"No recent data"),children:t?"Last updated: ".concat(new Date(t.timestamp).toLocaleString()):"No recent data"})]}),(0,a.jsx)("div",{className:"mt-4 p-4 rounded-xl border ".concat(l.color.replace("border","border-")),role:"alert","aria-label":"Air quality alert: ".concat(l.status),children:"HAZARDOUS"===l.status?(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-white",children:"Emergency Alert"}),(0,a.jsx)("p",{className:"text-sm text-gray-200 mt-1",children:"Air quality has reached hazardous levels. Take immediate protective actions as recommended above."})]})]}):"UNSAFE"===l.status?(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-red-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-white",children:"Health Alert"}),(0,a.jsx)("p",{className:"text-sm text-gray-200 mt-1",children:"Air quality is poor and may affect health. Follow all safety recommendations."})]})]}):"WARNING"===l.status?(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-orange-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-gray-300",children:"Caution Advised"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Air quality is poor. Sensitive individuals should take extra precautions."})]})]}):"CAUTION"===l.status?(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-white",children:"Monitor Conditions"}),(0,a.jsx)("p",{className:"text-sm text-gray-200 mt-1",children:"Air quality is moderate. Sensitive individuals should monitor conditions."})]})]}):"SAFE"===l.status?(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-gray-300",children:"Conditions are Normal"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Air quality is good. No special precautions needed."})]})]}):(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-500 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-gray-300",children:"Data Unavailable"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"System is unable to determine current air quality status."})]})]})})]})}function y(e){let{data:t}=e,{alerts:s,isSimulated:r}=function(e){let t=m();return{alerts:t.isSimulationMode?t.simulatedAlerts:e,isSimulated:t.isSimulationMode}}(t.map((e,t)=>{let s="low";return"Hazardous"===e.quality||"Very Poor"===e.quality?s="critical":"Poor"===e.quality?s="high":"Moderate"===e.quality&&(s="medium"),{id:"".concat(e.timestamp,"-").concat(t),timestamp:e.timestamp,ppm:e.ppm,quality:e.quality,severity:s,device_id:e.device_id,relay_state:e.relay_state,isSimulated:!1}})),[l,n]=(0,i.useState)(""),[o,d]=(0,i.useState)("all"),[c,u]=(0,i.useState)(1),[x]=(0,i.useState)(10),g=(0,i.useMemo)(()=>s,[s]),b=(0,i.useMemo)(()=>g.filter(e=>{let t=""===l||e.quality.toLowerCase().includes(l.toLowerCase())||e.device_id.toLowerCase().includes(l.toLowerCase())||e.ppm.toString().includes(l),s="all"===o||e.severity===o;return t&&s}),[g,l,o]),p=Math.ceil(b.length/x),v=b.slice((c-1)*x,c*x),w=e=>{switch(e){case"low":return"bg-green-500/30 text-white border border-green-500/30";case"medium":return"bg-yellow-500/30 text-white border border-yellow-500/30";case"high":return"bg-orange-500/30 text-white border border-orange-500/30";case"critical":return"bg-red-500/30 text-white border border-red-500/30";default:return"bg-gray-500/30 text-white border border-gray-500/30"}},f=e=>{switch(e){case"Excellent":return"text-white bg-green-500/30 border border-green-500/30";case"Good":return"text-white bg-blue-500/30 border border-blue-500/30";case"Moderate":return"text-white bg-yellow-500/30 border border-yellow-500/30";case"Poor":return"text-white bg-orange-500/30 border border-orange-500/30";case"Very Poor":return"text-white bg-red-500/30 border border-red-500/30";case"Hazardous":return"text-white bg-purple-500/30 border border-purple-500/30";default:return"text-white bg-gray-500/30 border border-gray-500/30"}},y=e=>{switch(e){case"low":return"\uD83D\uDFE2";case"medium":return"\uD83D\uDFE1";case"high":return"\uD83D\uDFE0";case"critical":return"\uD83D\uDD34";default:return"⚪"}};return(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 space-y-4 lg:space-y-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white/95",children:"Alert History & Logs"}),r&&(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 bg-yellow-500/20 px-2 py-1 rounded-full",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs font-medium text-white/90",children:"SIMULATED"})]})]}),(0,a.jsx)("button",{onClick:()=>{let e=new Blob([["Timestamp,Device ID,PPM,Quality,Severity,Relay State",...b.map(e=>[new Date(e.timestamp).toLocaleString(),e.device_id,e.ppm.toFixed(1),e.quality,e.severity,e.relay_state].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="air-quality-alerts-".concat(new Date().toISOString().split("T")[0],".csv"),s.click(),window.URL.revokeObjectURL(t)},className:"px-4 py-2 bg-white/20 text-white text-sm font-medium rounded-md hover:bg-white/30 transition-colors duration-200 backdrop-blur-sm border border-white/30",children:"Export CSV"})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Search by quality, device ID, or PPM...",value:l,onChange:e=>{n(e.target.value),u(1)},className:"w-full px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white/20 backdrop-blur-sm text-white placeholder:text-gray-300 border border-white/30"})}),(0,a.jsx)("div",{className:"flex gap-2",children:["all","low","medium","high","critical"].map(e=>(0,a.jsx)("button",{onClick:()=>{d(e),u(1)},className:"px-3 py-2 text-sm font-medium rounded-md transition-all duration-200 ".concat(o===e?"bg-blue-600 text-white shadow-md":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm border border-white/30"),children:"all"===e?"All":e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white/90",children:b.length}),(0,a.jsx)("div",{className:"text-xs text-white/90 font-medium",children:"Total Alerts"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white/90",children:b.filter(e=>"low"===e.severity).length}),(0,a.jsx)("div",{className:"text-xs text-white/90 font-medium",children:"Low Severity"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-white/90",children:b.filter(e=>"high"===e.severity||"critical"===e.severity).length}),(0,a.jsx)("div",{className:"text-xs text-white/90 font-medium",children:"High/Critical"})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-white/90",children:[b.length>0?(b.filter(e=>"high"===e.severity||"critical"===e.severity).length/b.length*100).toFixed(1):0,"%"]}),(0,a.jsx)("div",{className:"text-xs text-white/90 font-medium",children:"Critical Rate"})]})]}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:v.length>0?v.map(e=>(0,a.jsx)("div",{className:"p-4 border border-white/30 rounded-lg backdrop-blur-sm hover:bg-white/10 transition-colors duration-200 bg-white/10",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:y(e.severity)}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded-full ".concat(w(e.severity)),children:e.severity.toUpperCase()}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded-full ".concat(f(e.quality)),children:e.quality}),e.isSimulated&&(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100/30 text-white backdrop-blur-sm",children:"SIMULATED"})]}),(0,a.jsxs)("div",{className:"text-sm text-white/90",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.ppm.toFixed(1)," PPM"]}),(0,a.jsx)("span",{className:"mx-2",children:"•"}),(0,a.jsxs)("span",{children:["Device: ",e.device_id]}),(0,a.jsx)("span",{className:"mx-2",children:"•"}),(0,a.jsxs)("span",{children:["Relay: ",e.relay_state]})]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-white/90",children:new Date(e.timestamp).toLocaleDateString()}),(0,a.jsx)("div",{className:"text-xs text-white/80",children:new Date(e.timestamp).toLocaleTimeString()})]})]})},e.id)):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-white/90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("p",{className:"mt-2 text-lg font-medium text-white/90",children:"No alerts found"}),(0,a.jsx)("p",{className:"text-sm text-white/80",children:l||"all"!==o?"Try adjusting your filters":"No sensor data available yet"})]})}),p>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-white/90",children:["Showing ",(c-1)*x+1," to ",Math.min(c*x,b.length)," of ",b.length," alerts"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>u(e=>Math.max(e-1,1)),disabled:1===c,className:"px-3 py-1 text-sm font-medium rounded-md bg-white/20 text-white hover:bg-white/30 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 backdrop-blur-sm border border-white/30",children:"Previous"}),Array.from({length:Math.min(5,p)},(e,t)=>{let s;return s=p<=5?t+1:c<=3?t+1:c>=p-2?p-4+t:c-2+t,(0,a.jsx)("button",{onClick:()=>u(s),className:"px-3 py-1 text-sm font-medium rounded-md transition-colors duration-200 ".concat(c===s?"bg-blue-600 text-white shadow-md":"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm border border-white/30"),children:s},s)}),(0,a.jsx)("button",{onClick:()=>u(e=>Math.min(e+1,p)),disabled:c===p,className:"px-3 py-1 text-sm font-medium rounded-md bg-white/20 text-white hover:bg-white/30 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 backdrop-blur-sm border border-white/30",children:"Next"})]})]})]})}function j(){let{isSimulationMode:e,simulationState:t,stopSimulation:s}=m();return e?(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-yellow-400 text-black border-b-2 border-yellow-600 shadow-lg",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-black rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"font-bold text-sm",children:"⚠️ SIMULATION MODE ACTIVE"})]}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"All sensor data is fake"}),(0,a.jsxs)("span",{className:"text-xs bg-black text-yellow-400 px-2 py-1 rounded",children:[t.generatorState.ppm.toFixed(0)," PPM"]}),(0,a.jsx)("span",{className:"text-xs bg-black text-yellow-400 px-2 py-1 rounded",children:t.generatorState.quality}),(0,a.jsx)("span",{className:"text-xs bg-black text-yellow-400 px-2 py-1 rounded",children:t.generatorState.trend.toUpperCase()})]}),(0,a.jsx)("button",{onClick:s,className:"text-sm font-medium bg-black text-yellow-400 px-3 py-1 rounded hover:bg-gray-900 transition-colors",children:"Exit Simulation"})]})})}):null}s(5896),p.kL.register(p.uw,p.f$,p.od,p.jn,p.Dx,p.u,p.De,p.FB);var N=s(6410),S=s(5978),C=s(7292);function k(){let{user:e,logout:t,loading:s}=(0,r.a)(),n=(0,l.useRouter)(),[o,d]=(0,i.useState)(null),[c,m]=(0,i.useState)([]),[p,v]=(0,i.useState)(null),[k,D]=(0,i.useState)(!1),[M,P]=(0,i.useState)("overview"),[A,R]=(0,i.useState)(null),[E,I]=(0,i.useState)(null),{currentReading:O,historicalData:L,deviceOnline:_,deviceCommands:q,isSimulated:z}=u({currentReading:o,historicalData:c,deviceOnline:k,deviceCommands:p});if((0,i.useEffect)(()=>{e||s||n.push("/login")},[e,n,s]),(0,i.useEffect)(()=>{e&&N.I8&&N.db&&N.uE&&N.I8.currentUser&&!N.I8.currentUser.emailVerified&&I("Email not verified - please verify your email to continue")},[e,N.I8,N.db,N.uE]),(0,i.useEffect)(()=>{if(!e||!N.db||!N.uE)return;let t=(0,S.IO)((0,S.hJ)(N.db,"readings"),(0,S.Xo)("timestamp","desc"),(0,S.b9)(100)),s=(0,S.cf)(t,e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({device_id:s.device_id,ppm:s.ppm,quality:s.quality,relay_state:s.relay_state,timestamp:s.timestamp})}),m(t.reverse()),t.length>0&&d(t[t.length-1])},e=>{console.error("Error fetching sensor readings:",e),R("Failed to fetch sensor data: ".concat(e.message))}),a=(0,C.iH)(N.uE,"commands/esp32_01"),i=(0,C.jM)(a,e=>{let t=e.val();t&&v(t)},e=>{console.error("Error fetching device commands:",e),R("Failed to fetch device commands: ".concat(e.message))}),r=(0,C.iH)(N.uE,"devices/esp32_01"),l=(0,C.jM)(r,e=>{let t=e.val();t&&D("online"===t.status)},e=>{console.error("Error fetching device status:",e),R("Failed to fetch device status: ".concat(e.message))});return()=>{s(),i(),l()}},[e,N.db,N.uE]),s)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-transparent",children:(0,a.jsx)(h.Z,{className:"p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"loading-spinner w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-white font-medium",children:"Loading dashboard..."})]})})});if(!e)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-transparent",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Sign in to continue"}),(0,a.jsx)("p",{className:"text-white",children:"Please sign in to access your air quality dashboard"})]}),(0,a.jsx)("button",{onClick:()=>n.push("/login"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg",children:"Sign In"})]})});let H=(()=>{if(0===L.length)return{total:0,avg24h:0,alerts:0};let e=L.length,t=L.filter(e=>new Date(e.timestamp)>new Date(Date.now()-864e5));return{total:e,avg24h:t.length>0?t.reduce((e,t)=>e+t.ppm,0)/t.length:0,alerts:L.filter(e=>["Poor","Very Poor","Hazardous"].includes(e.quality)).length}})();return(0,a.jsxs)("div",{className:"min-h-screen bg-transparent",children:[(0,a.jsx)(j,{}),(0,a.jsx)("header",{className:"bg-white/20 backdrop-blur-sm shadow-lg border-b border-white/30",style:{marginTop:z?"48px":"0"},children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.293a1 1 0 00-1.414 1.414L14.586 10l-1.293 1.293a1 1 0 101.414 1.414L16 11.414l1.293 1.293a1 1 0 001.414-1.414L17.414 10l1.293-1.293a1 1 0 00-1.414-1.414L16 8.586l-1.293-1.293z",clipRule:"evenodd"})})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-white",children:"Air Quality Monitor"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-white font-medium",children:["Welcome, ",e.email]}),(0,a.jsx)("button",{onClick:async()=>{await t(),n.push("/")},className:"text-sm text-white hover:text-gray-300 px-3 py-1 rounded-md hover:bg-white/20 transition-colors duration-200",children:"Logout"})]})]})})}),(0,a.jsx)("div",{className:"bg-white/20 backdrop-blur-sm border-b border-white/30",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("nav",{className:"flex relative",children:[{id:"overview",label:"Overview",icon:"\uD83D\uDCCA"},{id:"charts",label:"Analytics",icon:"\uD83D\uDCC8"},{id:"history",label:"History",icon:"\uD83D\uDCCB"}].map(e=>(0,a.jsxs)("div",{className:"flex-1 relative",children:[M===e.id&&(0,a.jsx)("div",{className:"absolute bottom-0 h-1 bg-blue-500 transition-all duration-300 ease-in-out",style:{width:"calc(100% - 24px)",left:"12px"}}),(0,a.jsxs)("button",{onClick:()=>P(e.id),className:"w-full py-4 px-1 font-medium text-sm transition-colors duration-200 relative z-10 ".concat(M===e.id?"text-white":"text-white hover:text-gray-300"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]})]},e.id))})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===M&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(f,{reading:O,deviceOnline:_}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,a.jsx)(x,{reading:O}),(0,a.jsx)(g,{online:_,lastUpdate:null==O?void 0:O.timestamp}),(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Stats"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Total Readings"}),(0,a.jsx)("span",{className:"text-lg font-bold text-white",children:H.total})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Avg PPM (24h)"}),(0,a.jsx)("span",{className:"text-lg font-bold text-white",children:H.avg24h.toFixed(1)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsx)("span",{className:"text-sm text-white font-medium",children:"Total Alerts"}),(0,a.jsx)("span",{className:"text-lg font-bold text-white",children:H.alerts})]}),!k&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,a.jsx)("span",{className:"text-xs text-white font-medium",children:"ESP32 device is offline"})]})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{children:(0,a.jsx)(b,{currentCommands:q,onCommandUpdate:async e=>{try{console.log("Updating commands:",e)}catch(e){R("Failed to update device commands: "+(e instanceof Error?e.message:"Unknown error"))}}})}),(0,a.jsxs)(h.Z,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-3",children:[L.slice(-5).reverse().map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50/50 backdrop-blur-sm rounded-lg border border-white/30",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("Excellent"===e.quality||"Good"===e.quality?"bg-green-500":"Moderate"===e.quality?"bg-yellow-500":"bg-red-500")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-white",children:[e.ppm.toFixed(1)," PPM"]}),(0,a.jsx)("div",{className:"text-xs text-white",children:e.quality})]})]}),(0,a.jsx)("div",{className:"text-xs text-white",children:new Date(e.timestamp).toLocaleTimeString()})]},t)),0===L.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-white",children:[(0,a.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("p",{children:"No recent activity"})]})]})]})]})]}),"charts"===M&&(0,a.jsx)("div",{className:"space-y-6",children:L.length>0?(0,a.jsx)(h.Z,{className:"p-6",children:(0,a.jsx)(w,{data:L})}):(0,a.jsx)(h.Z,{className:"p-8",children:(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-white mb-4",children:(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No sensor data available"}),(0,a.jsxs)("p",{className:"text-white",children:[_?"Waiting for data from ESP32 device...":"ESP32 device is offline. Please check your device connection.",z&&" (Simulation will generate data shortly)"]})]})})}),"history"===M&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(y,{data:L})})]})]})}function D(){return(0,a.jsx)(c,{children:(0,a.jsx)(k,{})})}},2582:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return d}});var a=s(7437),i=s(2265),r=s(6410),l=s(2148);let n=(0,i.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(!r.I8){c(!1);return}return(0,l.Aj)(r.I8,e=>{o(e),c(!1)})},[]);let m=async(e,t)=>{if(!r.I8)throw Error("Authentication is not available in this environment");try{await (0,l.e5)(r.I8,e,t)}catch(t){let e="An error occurred during sign in";throw"auth/user-not-found"===t.code?e="No account found with this email address. Would you like to create an account?":"auth/wrong-password"===t.code?e="Incorrect password. Please try again or reset your password.":"auth/invalid-email"===t.code?e="Please enter a valid email address.":"auth/user-disabled"===t.code?e="This account has been disabled. Please contact support.":"auth/too-many-requests"===t.code&&(e="Too many failed attempts. Please try again later or reset your password."),Error(e)}},u=async(e,t)=>{if(!r.I8)throw Error("Authentication is not available in this environment");try{await (0,l.Xb)(r.I8,e,t)}catch(t){let e="An error occurred during sign up";throw"auth/email-already-in-use"===t.code?e="An account with this email already exists. Please sign in instead.":"auth/invalid-email"===t.code?e="Please enter a valid email address.":"auth/weak-password"===t.code?e="Password is too weak. Please use at least 6 characters.":"auth/operation-not-allowed"===t.code&&(e="Email/password accounts are not enabled. Please contact support."),Error(e)}},h=async()=>{if(r.I8)try{await (0,l.w7)(r.I8)}catch(e){throw e}};return(0,a.jsx)(n.Provider,{value:{user:s,loading:d,login:m,signup:u,logout:h},children:t})}function d(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3439:function(e,t,s){"use strict";var a=s(7437);s(2265),t.Z=e=>{let{children:t,className:s=""}=e;return(0,a.jsxs)("div",{className:"relative ".concat(s),children:[(0,a.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-white/20 backdrop-blur-sm border border-white/30 shadow-xl",style:{boxShadow:"inset 2px 2px 8px rgba(255, 255, 255, 0.3), inset -2px -2px 8px rgba(0, 0, 0, 0.1)",zIndex:0}}),(0,a.jsx)("div",{className:"relative z-10 p-4",children:t})]})}},6410:function(e,t,s){"use strict";s.d(t,{I8:function(){return c},db:function(){return m},uE:function(){return u}});var a=s(738),i=s(2148),r=s(5978),l=s(7292),n=s(6485);let o={apiKey:"AIzaSyAgCNERlOUnJyQsgFFGawHm9gIygUTxwQM",authDomain:"air-quality-monitor-c0862.firebaseapp.com",databaseURL:"https://air-quality-monitor-c0862-default-rtdb.firebaseio.com",projectId:"air-quality-monitor-c0862",storageBucket:"air-quality-monitor-c0862.appspot.com",messagingSenderId:"746914538418",appId:"1:746914538418:web:eb6322df4356c117affaab",measurementId:s(257).env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID||"G-C2WN5ME09P"},d=(0,a.ZF)(o),c=(0,i.v0)(d),m=(0,r.ad)(d),u=(0,l.N8)(d);(0,n.cF)(d)}},function(e){e.O(0,[609,401,324,674,883,279,971,117,744],function(){return e(e.s=9521)}),_N_E=e.O()}]);