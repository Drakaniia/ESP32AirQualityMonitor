{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null",
    "commands": {
      "$deviceId": {
        ".read": "auth != null",
        ".write": "auth != null && auth.uid === 'admin_user'",
        ".validate": "newData.hasChildren(['relay_state', 'sampling_interval', 'oled_message', 'last_update'])",
        "relay_state": {
          ".validate": "newData.isString() && (newData.val() === 'ON' || newData.val() === 'OFF')"
        },
        "sampling_interval": {
          ".validate": "newData.isNumber() && newData.val() >= 1 && newData.val() <= 300"
        },
        "oled_message": {
          ".validate": "newData.isString() && newData.val().length <= 50"
        },
        "last_update": {
          ".validate": "newData.isNumber()"
        }
      }
    },
    "devices": {
      "$deviceId": {
        ".read": "auth != null",
        ".write": "auth != null && (auth.uid === 'esp32_device' || auth.uid === 'admin_user')",
        ".validate": "newData.hasChildren(['status', 'last_seen'])",
        "status": {
          ".validate": "newData.isString() && (newData.val() === 'online' || newData.val() === 'offline')"
        },
        "last_seen": {
          ".validate": "newData.isNumber()"
        }
      }
    }
  }
}